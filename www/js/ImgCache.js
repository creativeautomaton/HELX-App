directives.directive("cachedImage",function(){return{restrict:"E",scope:{"class":"@",image:"@",transclude:"@"},link:function(e,a,c){function n(){if(e.transclude||o.html('<i class="icon icon-md ion-ios7-reloading"></i>'),ImgCache.ready)o.css("background-image",'url("'+e.image+'")'),ImgCache.cacheBackground(o,function(){i(),ImgCache.useCachedBackground(o)},function(){console.error("Could not download image (ImgCache)."),i()});else{var a=new Image;a.src=e.image,a.onload=function(){i(),o.css("background-image",'url("'+e.image+'")')},a.onerror=function(){console.error("Could not download image."),i()}}}function i(){e.transclude||o.html("")}var o=angular.element(a.children()[0]);e.$watch("image",function(a,c){a&&(ImgCache.ready?ImgCache.isCached(e.image,function(a,c){c?(i(),o.css("background-image",'url("'+e.image+'")'),ImgCache.useCachedBackground(o)):n()}):n())})},transclude:!0,template:'<div class="" ng-transclude></div>'}});